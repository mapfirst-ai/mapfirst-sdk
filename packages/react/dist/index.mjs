import s from"react";import{MapFirstCore as g}from"@mapfirst.ai/core";import{jsx as d,jsxs as M}from"react/jsx-runtime";function h(t){let n=s.useRef(null),[a,c]=s.useState(null),l=s.useRef(t);return s.useEffect(()=>{l.current=t}),s.useEffect(()=>{let p=l.current,f={adapter:null,...p,callbacks:{...p.callbacks,onPropertiesChange:o=>{var e,r;c(u=>u?{...u,properties:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onPropertiesChange)==null||r.call(e,o)},onSelectedPropertyChange:o=>{var e,r;c(u=>u?{...u,selectedPropertyId:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onSelectedPropertyChange)==null||r.call(e,o)},onPrimaryTypeChange:o=>{var e,r;c(u=>u?{...u,primary:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onPrimaryTypeChange)==null||r.call(e,o)},onFiltersChange:o=>{var e,r;c(u=>u?{...u,filters:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onFiltersChange)==null||r.call(e,o)},onBoundsChange:o=>{var e,r;c(u=>u?{...u,bounds:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onBoundsChange)==null||r.call(e,o)},onCenterChange:(o,e)=>{var r,u;c(y=>y?{...y,center:o,zoom:e}:null),(u=(r=l.current.callbacks)==null?void 0:r.onCenterChange)==null||u.call(r,o,e)},onZoomChange:o=>{var e,r;c(u=>u?{...u,zoom:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onZoomChange)==null||r.call(e,o)},onActiveLocationChange:o=>{var e,r;c(u=>u?{...u,activeLocation:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onActiveLocationChange)==null||r.call(e,o)},onLoadingStateChange:o=>{var e,r;c(u=>u?{...u,initialLoading:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onLoadingStateChange)==null||r.call(e,o)},onSearchingStateChange:o=>{var e,r;c(u=>u?{...u,isSearching:o}:null),(r=(e=l.current.callbacks)==null?void 0:e.onSearchingStateChange)==null||r.call(e,o)}}},i=new g(f);return n.current=i,c(i.getState()),()=>{i.destroy(),n.current=null,c(null)}},[]),{mapFirst:n.current,state:a}}function b(t){let[n,a]=s.useState([]);return s.useEffect(()=>{if(!t){a([]);return}a(t.getState().properties)},[t]),n}function P(t){let[n,a]=s.useState(null);return s.useEffect(()=>{if(!t){a(null);return}a(t.getState().selectedPropertyId)},[t]),n}function k(t){let[n,a]=s.useState("Accommodation");s.useEffect(()=>{if(!t){a("Accommodation");return}a(t.getState().primary)},[t]);let c=s.useCallback(l=>{t&&(t.setPrimaryType(l),a(l))},[t]);return[n,c]}function m(t){let[n,a]=s.useState(null);s.useEffect(()=>{if(!t){a(null);return}console.log("useSelectedMarker: mapFirst available"),a(t.getState().selectedPropertyId)},[t]);let c=s.useCallback(l=>{t&&t.setSelectedMarker(l)},[t]);return[n,c]}function x({mapFirst:t,map:n,maplibregl:a,onMarkerClick:c}){let l=s.useRef(!1);s.useEffect(()=>{!t||!n||l.current||(t.attachMap(n,{platform:"maplibre",maplibregl:a,onMarkerClick:c}),l.current=!0)},[t,n,a,c])}function R({mapFirst:t,map:n,google:a,onMarkerClick:c}){let l=s.useRef(!1);s.useEffect(()=>{!t||!n||l.current||(t.attachMap(n,{platform:"google",google:a,onMarkerClick:c}),l.current=!0)},[t,n,a,c])}function T({mapFirst:t,map:n,mapboxgl:a,onMarkerClick:c}){let l=s.useRef(!1);s.useEffect(()=>{!t||!n||l.current||(t.attachMap(n,{platform:"mapbox",mapboxgl:a,onMarkerClick:c}),l.current=!0)},[t,n,a,c])}function E(t){let n=s.useRef(null);return s.useEffect(()=>{if(!t)return;let a=new g(t);return n.current=a,()=>{a.destroy(),n.current=null}},[t]),n}function L({markers:t}){return M("div",{style:{fontFamily:"sans-serif",fontSize:14},children:[d("strong",{children:"Markers"}),d("ul",{children:t.map(n=>{var a,c,l,p,f,i;return M("li",{children:[n.name," \u2014 ",(l=(c=(a=n.location)==null?void 0:a.lat)==null?void 0:c.toFixed(3))!=null?l:"n/a",","," ",(i=(f=(p=n.location)==null?void 0:p.lon)==null?void 0:f.toFixed(3))!=null?i:"n/a"]},String(n.tripadvisor_id))})})]})}export{L as MarkerDebugList,R as useGoogleMapsAttachment,E as useMapFirst,h as useMapFirstCore,b as useMapFirstProperties,P as useMapFirstSelectedProperty,x as useMapLibreAttachment,T as useMapboxAttachment,k as usePrimaryType,m as useSelectedMarker};
//# sourceMappingURL=index.mjs.map