import c from"react";import{MapFirstCore as b}from"@mapfirst.ai/core";import{jsx as g,jsxs as d}from"react/jsx-runtime";function h(r){let a=c.useRef(null),[o,l]=c.useState(null),n=c.useRef(r);return c.useEffect(()=>{n.current=r}),c.useEffect(()=>{let y=n.current,p={adapter:null,...y,callbacks:{...y.callbacks,onPropertiesChange:t=>{var e,s;l(u=>u?{...u,properties:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onPropertiesChange)==null||s.call(e,t)},onSelectedPropertyChange:t=>{var e,s;l(u=>u?{...u,selectedPropertyId:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onSelectedPropertyChange)==null||s.call(e,t)},onPrimaryTypeChange:t=>{var e,s;l(u=>u?{...u,primary:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onPrimaryTypeChange)==null||s.call(e,t)},onFiltersChange:t=>{var e,s;l(u=>u?{...u,filters:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onFiltersChange)==null||s.call(e,t)},onBoundsChange:t=>{var e,s;l(u=>u?{...u,bounds:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onBoundsChange)==null||s.call(e,t)},onCenterChange:(t,e)=>{var s,u;l(f=>f?{...f,center:t,zoom:e}:null),(u=(s=n.current.callbacks)==null?void 0:s.onCenterChange)==null||u.call(s,t,e)},onZoomChange:t=>{var e,s;l(u=>u?{...u,zoom:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onZoomChange)==null||s.call(e,t)},onActiveLocationChange:t=>{var e,s;l(u=>u?{...u,activeLocation:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onActiveLocationChange)==null||s.call(e,t)},onLoadingStateChange:t=>{var e,s;l(u=>u?{...u,initialLoading:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onLoadingStateChange)==null||s.call(e,t)},onSearchingStateChange:t=>{var e,s;l(u=>u?{...u,isSearching:t}:null),(s=(e=n.current.callbacks)==null?void 0:e.onSearchingStateChange)==null||s.call(e,t)}}},i=new b(p);return a.current=i,l(i.getState()),()=>{i.destroy(),a.current=null,l(null)}},[]),{mapFirst:a.current,state:o}}function M(r){let[a,o]=c.useState([]);return c.useEffect(()=>{if(!r){o([]);return}o(r.getState().properties)},[r]),a}function C(r){let[a,o]=c.useState(null);return c.useEffect(()=>{if(!r){o(null);return}o(r.getState().selectedPropertyId)},[r]),a}function P(r){let[a,o]=c.useState("Accommodation");c.useEffect(()=>{if(!r){o("Accommodation");return}o(r.getState().primary)},[r]);let l=c.useCallback(n=>{r&&(r.setPrimaryType(n),o(n))},[r]);return[a,l]}function E(r){let[a,o]=c.useState(null);c.useEffect(()=>{if(!r){o(null);return}o(r.getState().selectedPropertyId)},[r]);let l=c.useCallback(n=>{r&&r.setSelectedMarker(n)},[r]);return[a,l]}function k({mapFirst:r,map:a,maplibregl:o,onMarkerClick:l}){let n=c.useRef(!1);c.useEffect(()=>{!r||!a||n.current||(r.attachMap(a,{platform:"maplibre",maplibregl:o,onMarkerClick:l}),n.current=!0)},[r,a,o,l])}function R({mapFirst:r,map:a,google:o,onMarkerClick:l}){let n=c.useRef(!1);c.useEffect(()=>{!r||!a||n.current||(r.attachMap(a,{platform:"google",google:o,onMarkerClick:l}),n.current=!0)},[r,a,o,l])}function x({mapFirst:r,map:a,mapboxgl:o,onMarkerClick:l}){let n=c.useRef(!1);c.useEffect(()=>{!r||!a||n.current||(r.attachMap(a,{platform:"mapbox",mapboxgl:o,onMarkerClick:l}),n.current=!0)},[r,a,o,l])}function F(r){let a=c.useRef(null);return c.useEffect(()=>{if(!r)return;let o=new b(r);return a.current=o,()=>{o.destroy(),a.current=null}},[r]),a}function w(r){let[a,o]=c.useState(!1),[l,n]=c.useState(null);return{search:c.useCallback(async p=>{if(!r){let i=new Error("MapFirst instance not available");throw n(i),i}o(!0),n(null);try{return await r.runPropertiesSearch({...p,onError:t=>{let e=t instanceof Error?t:new Error(String(t));n(e)}})}catch(i){let t=i instanceof Error?i:new Error(String(i));throw n(t),t}finally{o(!1)}},[r]),isLoading:a,error:l}}function L(r){let[a,o]=c.useState(!1),[l,n]=c.useState(null);return{search:c.useCallback(async p=>{if(!r){let i=new Error("MapFirst instance not available");throw n(i),i}o(!0),n(null);try{return await r.runSmartFilterSearch({...p,onError:t=>{let e=t instanceof Error?t:new Error(String(t));n(e)}})}catch(i){let t=i instanceof Error?i:new Error(String(i));throw n(t),t}finally{o(!1)}},[r]),isLoading:a,error:l}}function T({markers:r}){return d("div",{style:{fontFamily:"sans-serif",fontSize:14},children:[g("strong",{children:"Markers"}),g("ul",{children:r.map(a=>{var o,l,n,y,p,i;return d("li",{children:[a.name," \u2014 ",(n=(l=(o=a.location)==null?void 0:o.lat)==null?void 0:l.toFixed(3))!=null?n:"n/a",","," ",(i=(p=(y=a.location)==null?void 0:y.lon)==null?void 0:p.toFixed(3))!=null?i:"n/a"]},String(a.tripadvisor_id))})})]})}export{T as MarkerDebugList,R as useGoogleMapsAttachment,F as useMapFirst,h as useMapFirstCore,M as useMapFirstProperties,C as useMapFirstSelectedProperty,k as useMapLibreAttachment,x as useMapboxAttachment,P as usePrimaryType,w as usePropertiesSearch,E as useSelectedMarker,L as useSmartFilterSearch};
//# sourceMappingURL=index.mjs.map