"use strict";var m=Object.create;var g=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var E=(e,t)=>{for(var a in t)g(e,a,{get:t[a],enumerable:!0})},S=(e,t,a,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of M(t))!P.call(e,n)&&n!==a&&g(e,n,{get:()=>t[n],enumerable:!(l=h(t,n))||l.enumerable});return e};var k=(e,t,a)=>(a=e!=null?m(C(e)):{},S(t||!e||!e.__esModule?g(a,"default",{value:e,enumerable:!0}):a,e)),R=e=>S(g({},"__esModule",{value:!0}),e);var q={};E(q,{MarkerDebugList:()=>O,useGoogleMapsAttachment:()=>A,useMapFirst:()=>v,useMapFirstCore:()=>x,useMapFirstProperties:()=>F,useMapFirstSelectedProperty:()=>w,useMapLibreAttachment:()=>I,useMapboxAttachment:()=>_,usePrimaryType:()=>L,usePropertiesSearch:()=>B,useSelectedMarker:()=>T,useSmartFilterSearch:()=>N});module.exports=R(q);var u=k(require("react")),d=require("@mapfirst.ai/core"),f=require("react/jsx-runtime");function x(e){let t=u.default.useRef(null),[a,l]=u.default.useState(null),n=u.default.useRef(e);return u.default.useEffect(()=>{n.current=e}),u.default.useEffect(()=>{let y=n.current,p={adapter:null,...y,callbacks:{...y.callbacks,onPropertiesChange:o=>{var r,s;l(c=>c?{...c,properties:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onPropertiesChange)==null||s.call(r,o)},onSelectedPropertyChange:o=>{var r,s;l(c=>c?{...c,selectedPropertyId:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onSelectedPropertyChange)==null||s.call(r,o)},onPrimaryTypeChange:o=>{var r,s;l(c=>c?{...c,primary:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onPrimaryTypeChange)==null||s.call(r,o)},onFiltersChange:o=>{var r,s;l(c=>c?{...c,filters:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onFiltersChange)==null||s.call(r,o)},onBoundsChange:o=>{var r,s;l(c=>c?{...c,bounds:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onBoundsChange)==null||s.call(r,o)},onCenterChange:(o,r)=>{var s,c;l(b=>b?{...b,center:o,zoom:r}:null),(c=(s=n.current.callbacks)==null?void 0:s.onCenterChange)==null||c.call(s,o,r)},onZoomChange:o=>{var r,s;l(c=>c?{...c,zoom:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onZoomChange)==null||s.call(r,o)},onActiveLocationChange:o=>{var r,s;l(c=>c?{...c,activeLocation:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onActiveLocationChange)==null||s.call(r,o)},onLoadingStateChange:o=>{var r,s;l(c=>c?{...c,initialLoading:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onLoadingStateChange)==null||s.call(r,o)},onSearchingStateChange:o=>{var r,s;l(c=>c?{...c,isSearching:o}:null),(s=(r=n.current.callbacks)==null?void 0:r.onSearchingStateChange)==null||s.call(r,o)}}},i=new d.MapFirstCore(p);return t.current=i,l(i.getState()),()=>{i.destroy(),t.current=null,l(null)}},[]),{mapFirst:t.current,state:a}}function F(e){let[t,a]=u.default.useState([]);return u.default.useEffect(()=>{if(!e){a([]);return}a(e.getState().properties)},[e]),t}function w(e){let[t,a]=u.default.useState(null);return u.default.useEffect(()=>{if(!e){a(null);return}a(e.getState().selectedPropertyId)},[e]),t}function L(e){let[t,a]=u.default.useState("Accommodation");u.default.useEffect(()=>{if(!e){a("Accommodation");return}a(e.getState().primary)},[e]);let l=u.default.useCallback(n=>{e&&(e.setPrimaryType(n),a(n))},[e]);return[t,l]}function T(e){let[t,a]=u.default.useState(null);u.default.useEffect(()=>{if(!e){a(null);return}a(e.getState().selectedPropertyId)},[e]);let l=u.default.useCallback(n=>{e&&e.setSelectedMarker(n)},[e]);return[t,l]}function I({mapFirst:e,map:t,maplibregl:a,onMarkerClick:l}){let n=u.default.useRef(!1);u.default.useEffect(()=>{!e||!t||n.current||(e.attachMap(t,{platform:"maplibre",maplibregl:a,onMarkerClick:l}),n.current=!0)},[e,t,a,l])}function A({mapFirst:e,map:t,google:a,onMarkerClick:l}){let n=u.default.useRef(!1);u.default.useEffect(()=>{!e||!t||n.current||(e.attachMap(t,{platform:"google",google:a,onMarkerClick:l}),n.current=!0)},[e,t,a,l])}function _({mapFirst:e,map:t,mapboxgl:a,onMarkerClick:l}){let n=u.default.useRef(!1);u.default.useEffect(()=>{!e||!t||n.current||(e.attachMap(t,{platform:"mapbox",mapboxgl:a,onMarkerClick:l}),n.current=!0)},[e,t,a,l])}function v(e){let t=u.default.useRef(null);return u.default.useEffect(()=>{if(!e)return;let a=new d.MapFirstCore(e);return t.current=a,()=>{a.destroy(),t.current=null}},[e]),t}function B(e){let[t,a]=u.default.useState(!1),[l,n]=u.default.useState(null);return{search:u.default.useCallback(async p=>{if(!e){let i=new Error("MapFirst instance not available");throw n(i),i}a(!0),n(null);try{return await e.runPropertiesSearch({...p,onError:o=>{let r=o instanceof Error?o:new Error(String(o));n(r)}})}catch(i){let o=i instanceof Error?i:new Error(String(i));throw n(o),o}finally{a(!1)}},[e]),isLoading:t,error:l}}function N(e){let[t,a]=u.default.useState(!1),[l,n]=u.default.useState(null);return{search:u.default.useCallback(async p=>{if(!e){let i=new Error("MapFirst instance not available");throw n(i),i}a(!0),n(null);try{return await e.runSmartFilterSearch({...p,onError:o=>{let r=o instanceof Error?o:new Error(String(o));n(r)}})}catch(i){let o=i instanceof Error?i:new Error(String(i));throw n(o),o}finally{a(!1)}},[e]),isLoading:t,error:l}}function O({markers:e}){return(0,f.jsxs)("div",{style:{fontFamily:"sans-serif",fontSize:14},children:[(0,f.jsx)("strong",{children:"Markers"}),(0,f.jsx)("ul",{children:e.map(t=>{var a,l,n,y,p,i;return(0,f.jsxs)("li",{children:[t.name," \u2014 ",(n=(l=(a=t.location)==null?void 0:a.lat)==null?void 0:l.toFixed(3))!=null?n:"n/a",","," ",(i=(p=(y=t.location)==null?void 0:y.lon)==null?void 0:p.toFixed(3))!=null?i:"n/a"]},String(t.tripadvisor_id))})})]})}0&&(module.exports={MarkerDebugList,useGoogleMapsAttachment,useMapFirst,useMapFirstCore,useMapFirstProperties,useMapFirstSelectedProperty,useMapLibreAttachment,useMapboxAttachment,usePrimaryType,usePropertiesSearch,useSelectedMarker,useSmartFilterSearch});
//# sourceMappingURL=index.js.map