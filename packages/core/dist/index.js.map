{"version":3,"sources":["../src/index.ts","../src/adapters/index.ts","../src/adapters/maplibre.ts","../src/dotmarket.ts","../src/marker.ts"],"sourcesContent":["import type { MapAdapter } from \"./adapters\";\nimport { MapLibreAdapter } from \"./adapters/maplibre\";\nimport { createDotMarkerElement } from \"./dotmarket\";\nimport { createPrimaryMarkerElement } from \"./marker\";\nimport type { Property, PropertyType } from \"./types\";\n\nexport type { Property, PropertyType } from \"./types\";\n\nexport type MapLibreMarkerHandle = {\n  setLngLat(lngLat: [number, number]): MapLibreMarkerHandle;\n  addTo(map: any): MapLibreMarkerHandle;\n  remove(): void;\n  getElement(): HTMLElement;\n};\n\nexport type MapLibreNamespace = {\n  Marker: new (options?: {\n    element?: HTMLElement;\n    anchor?: string;\n  }) => MapLibreMarkerHandle;\n};\n\ntype BaseMapFirstOptions = {\n  markers?: Property[];\n  primaryType?: PropertyType;\n  selectedMarkerId?: number | null;\n  clusterRadiusMeters?: number;\n  autoSelectOnClick?: boolean;\n  onClusterUpdate?: (\n    clusters: ClusterDisplayItem[],\n    viewState: ViewStateSnapshot | null\n  ) => void;\n};\n\ntype AdapterDrivenOptions = BaseMapFirstOptions & {\n  adapter: MapAdapter;\n  platform?: undefined;\n};\n\ntype MapLibreOptions = BaseMapFirstOptions & {\n  platform: \"maplibre\";\n  mapInstance: any;\n  maplibregl: MapLibreNamespace;\n  onMarkerClick?: (marker: Property) => void;\n};\n\nexport type MapFirstOptions = AdapterDrivenOptions | MapLibreOptions;\n\nconst DEFAULT_PRIMARY_TYPE: PropertyType = \"Accommodation\";\n\nexport type ClusterDisplayItem =\n  | {\n      kind: \"primary\";\n      marker: Property;\n      key: string;\n    }\n  | {\n      kind: \"dot\";\n      marker: Property;\n      key: string;\n      parentId: number;\n    };\n\nexport class MapFirstCore {\n  private readonly adapter: MapAdapter;\n  private readonly cleanupFns: Array<() => void> = [];\n  private readonly markerRenderer?: MapLibreMarkerManager;\n  private markers: Property[] = [];\n  private primaryType?: PropertyType;\n  private selectedMarkerId: number | null = null;\n  private destroyed = false;\n  private clusterItems: ClusterDisplayItem[] = [];\n\n  constructor(private readonly options: MapFirstOptions) {\n    this.markers = [...(options.markers ?? [])];\n    this.primaryType = options.primaryType;\n    this.selectedMarkerId = options.selectedMarkerId ?? null;\n\n    if (isMapLibreOptions(options)) {\n      const shouldAutoSelect = options.autoSelectOnClick ?? true;\n      this.adapter = new MapLibreAdapter(options.mapInstance);\n      this.markerRenderer = new MapLibreMarkerManager({\n        mapInstance: options.mapInstance,\n        maplibregl: options.maplibregl,\n        onMarkerClick: (marker) => {\n          if (shouldAutoSelect) {\n            this.setSelectedMarker(marker.tripadvisor_id);\n          }\n          options.onMarkerClick?.(marker);\n        },\n      });\n      this.attachMapLibreListeners(options.mapInstance);\n    } else {\n      this.adapter = options.adapter;\n    }\n\n    this.refresh();\n  }\n\n  setMarkers(markers: Property[]) {\n    this.ensureAlive();\n    this.markers = [...markers];\n    this.refresh();\n  }\n\n  addMarker(marker: Property) {\n    this.ensureAlive();\n    this.markers = [...this.markers, marker];\n    this.refresh();\n  }\n\n  clearMarkers() {\n    this.ensureAlive();\n    this.markers = [];\n    this.refresh();\n  }\n\n  setPrimaryType(primary: PropertyType) {\n    this.ensureAlive();\n    if (this.primaryType === primary) return;\n    this.primaryType = primary;\n    this.refresh();\n  }\n\n  setSelectedMarker(markerId: number | null) {\n    this.ensureAlive();\n    if (this.selectedMarkerId === markerId) return;\n    this.selectedMarkerId = markerId;\n    this.refresh();\n  }\n\n  getClusters(): ClusterDisplayItem[] {\n    this.ensureAlive();\n    return [...this.clusterItems];\n  }\n\n  refresh() {\n    this.ensureAlive();\n    const viewState = this.safeExtractViewState();\n    const primaryType = this.resolvePrimaryType();\n\n    const { collisionPx, dotPx } = this.resolveCollisionOverrides(viewState);\n\n    this.clusterItems = clusterMarkers({\n      primaryType,\n      markers: this.markers,\n      map: this.adapter.getMap(),\n      selectedMarkerId: this.selectedMarkerId,\n      zoom: viewState?.zoom ?? 0,\n      collisionThresholdPx: collisionPx,\n      dotCollisionThresholdPx: dotPx,\n    });\n\n    this.markerRenderer?.render(this.clusterItems);\n\n    this.options.onClusterUpdate?.(this.clusterItems, viewState);\n  }\n\n  destroy() {\n    if (this.destroyed) {\n      return;\n    }\n    this.markerRenderer?.destroy();\n    for (const cleanup of this.cleanupFns) {\n      try {\n        cleanup();\n      } catch {\n        // ignore listener failures on teardown\n      }\n    }\n    this.cleanupFns.length = 0;\n    this.clusterItems = [];\n    this.markers = [];\n    this.destroyed = true;\n  }\n\n  private resolvePrimaryType(): PropertyType {\n    return (\n      this.primaryType ??\n      this.markers.find((marker) => marker.type)?.type ??\n      DEFAULT_PRIMARY_TYPE\n    );\n  }\n\n  private safeExtractViewState(): ViewStateSnapshot | null {\n    try {\n      return extractViewState(this.adapter);\n    } catch {\n      return null;\n    }\n  }\n\n  private resolveCollisionOverrides(viewState: ViewStateSnapshot | null) {\n    if (!viewState) {\n      return { collisionPx: undefined, dotPx: undefined };\n    }\n    const radiusMeters = this.options.clusterRadiusMeters;\n    if (!radiusMeters || !Number.isFinite(radiusMeters) || radiusMeters <= 0) {\n      return { collisionPx: undefined, dotPx: undefined };\n    }\n    const collisionPx = metersToPixels(\n      radiusMeters,\n      viewState.latitude,\n      viewState.zoom\n    );\n    if (!Number.isFinite(collisionPx) || collisionPx <= 0) {\n      return { collisionPx: undefined, dotPx: undefined };\n    }\n    const normalized = Math.max(32, Math.round(collisionPx));\n    const dotPx = Math.max(48, normalized);\n    return { collisionPx: normalized, dotPx };\n  }\n\n  private attachMapLibreListeners(mapInstance: any) {\n    if (!mapInstance || typeof mapInstance.on !== \"function\") {\n      return;\n    }\n    const rerender = () => this.refresh();\n    const events = [\"move\", \"zoom\", \"dragend\", \"pitch\", \"rotate\"];\n    events.forEach((eventName) => {\n      mapInstance.on(eventName, rerender);\n      this.cleanupFns.push(() => {\n        if (typeof mapInstance.off === \"function\") {\n          mapInstance.off(eventName, rerender);\n        }\n      });\n    });\n  }\n\n  private ensureAlive() {\n    if (this.destroyed) {\n      throw new Error(\"MapFirstCore instance has been destroyed\");\n    }\n  }\n}\n\ntype ViewStateSnapshot = {\n  longitude: number;\n  latitude: number;\n  zoom: number;\n  bearing: number;\n  pitch: number;\n};\n\ntype ClusterParams = {\n  primaryType: PropertyType;\n  markers: Property[];\n  map: MapAdapter | null;\n  selectedMarkerId: number | null;\n  zoom: number;\n  collisionThresholdPx?: number;\n  dotCollisionThresholdPx?: number;\n};\n\ntype ProjectedMarker = {\n  marker: Property;\n  index: number;\n  x: number;\n  y: number;\n};\n\nfunction isMapLibreOptions(\n  options: MapFirstOptions\n): options is MapLibreOptions {\n  return (options as MapLibreOptions).platform === \"maplibre\";\n}\n\nfunction extractViewState(mapInstance: MapAdapter): ViewStateSnapshot {\n  const center = mapInstance.getCenter();\n  return {\n    longitude: center.lng,\n    latitude: center.lat,\n    zoom: mapInstance.getZoom(),\n    bearing: mapInstance.getBearing(),\n    pitch: mapInstance.getPitch(),\n  };\n}\n\nconst COLLISION_THRESHOLD_PX_ZOOM_BREAKPOINTS: Array<{\n  zoom: number;\n  threshold: number;\n}> = [\n  { zoom: 6, threshold: 120 },\n  { zoom: 8, threshold: 108 },\n  { zoom: 10, threshold: 92 },\n  { zoom: 12, threshold: 80 },\n  { zoom: 14, threshold: 68 },\n  { zoom: 16, threshold: 56 },\n];\n\nfunction resolveCollisionThreshold(zoom: number) {\n  for (const breakpoint of COLLISION_THRESHOLD_PX_ZOOM_BREAKPOINTS) {\n    if (zoom <= breakpoint.zoom) {\n      return breakpoint.threshold;\n    }\n  }\n  return 48;\n}\n\nfunction clusterMarkers({\n  primaryType,\n  markers,\n  map,\n  selectedMarkerId,\n  zoom,\n  collisionThresholdPx,\n  dotCollisionThresholdPx,\n}: ClusterParams): ClusterDisplayItem[] {\n  if (!markers.length) return [];\n  if (!map) {\n    return markers.map((marker) => ({\n      kind: \"primary\" as const,\n      marker,\n      key: `primary-${marker.tripadvisor_id}`,\n    }));\n  }\n\n  const projected: ProjectedMarker[] = markers\n    .map((marker, index) => {\n      const location = marker.location as { lon?: number; lat?: number };\n      if (\n        typeof location?.lon !== \"number\" ||\n        typeof location?.lat !== \"number\"\n      ) {\n        return null;\n      }\n      const { x, y } = map.project([location.lon, location.lat]);\n      return { marker, index, x, y };\n    })\n    .filter((value): value is ProjectedMarker => Boolean(value));\n\n  if (!projected.length) {\n    return [];\n  }\n\n  const threshold = resolveCollisionThreshold(zoom);\n  const dotThreshold = resolveDotCollisionThreshold(zoom);\n  const parent = projected.map((_, idx) => idx);\n\n  const find = (i: number): number => {\n    if (parent[i] === i) return i;\n    parent[i] = find(parent[i]);\n    return parent[i];\n  };\n\n  const union = (a: number, b: number) => {\n    const rootA = find(a);\n    const rootB = find(b);\n    if (rootA === rootB) return;\n    parent[rootB] = rootA;\n  };\n\n  for (let i = 0; i < projected.length; i += 1) {\n    for (let j = i + 1; j < projected.length; j += 1) {\n      const dx = projected[i].x - projected[j].x;\n      const dy = projected[i].y - projected[j].y;\n      if (Math.hypot(dx, dy) <= threshold) {\n        union(i, j);\n      }\n    }\n  }\n\n  const groups = new Map<number, ProjectedMarker[]>();\n  for (const item of projected) {\n    const root = find(item.index);\n    const group = groups.get(root);\n    if (group) {\n      group.push(item);\n    } else {\n      groups.set(root, [item]);\n    }\n  }\n\n  const clustered: ClusterDisplayItem[] = [];\n\n  groups.forEach((groupItems) => {\n    if (groupItems.length === 1) {\n      const [{ marker }] = groupItems;\n      clustered.push({\n        kind: \"primary\",\n        marker,\n        key: `primary-${marker.tripadvisor_id}`,\n      });\n      return;\n    }\n\n    const sorted = [...groupItems].sort((a, b) =>\n      compareMarkers(b.marker, a.marker, primaryType)\n    );\n    const [primary, ...rest] = sorted;\n    clustered.push({\n      kind: \"primary\",\n      marker: primary.marker,\n      key: `primary-${primary.marker.tripadvisor_id}`,\n    });\n\n    if (!rest.length) return;\n\n    const dotCandidates: ProjectedMarker[] = [];\n    const remainder: ProjectedMarker[] = [];\n\n    rest.forEach((item) => {\n      if (selectedMarkerId && item.marker.tripadvisor_id === selectedMarkerId) {\n        clustered.push({\n          kind: \"primary\",\n          marker: item.marker,\n          key: `primary-${item.marker.tripadvisor_id}`,\n        });\n        return;\n      }\n\n      if (distancePx(primary, item) <= dotThreshold) {\n        dotCandidates.push(item);\n      } else {\n        remainder.push(item);\n      }\n    });\n\n    dotCandidates.forEach((item) => {\n      clustered.push({\n        kind: \"dot\",\n        marker: item.marker,\n        key: `dot-${item.marker.tripadvisor_id}`,\n        parentId: primary.marker.tripadvisor_id,\n      });\n    });\n\n    if (remainder.length) {\n      const followUp = clusterMarkers({\n        markers: remainder.map((item) => item.marker),\n        map,\n        selectedMarkerId,\n        zoom,\n        primaryType,\n        collisionThresholdPx,\n        dotCollisionThresholdPx,\n      });\n      clustered.push(...followUp);\n    }\n  });\n\n  return clustered;\n}\n\nfunction distancePx(a: ProjectedMarker, b: ProjectedMarker) {\n  return Math.hypot(a.x - b.x, a.y - b.y);\n}\n\nfunction resolveDotCollisionThreshold(zoom: number) {\n  const base = resolveCollisionThreshold(zoom);\n  return Math.max(48, base);\n}\n\nfunction compareMarkers(a: Property, b: Property, primaryType: PropertyType) {\n  const aIsPrimary = a.type === primaryType;\n  const bIsPrimary = b.type === primaryType;\n  if (aIsPrimary && !bIsPrimary) return 1;\n  if (!aIsPrimary && bIsPrimary) return -1;\n\n  const ratingDiff = resolveRating(a) - resolveRating(b);\n  if (ratingDiff !== 0) return ratingDiff;\n\n  const priceDiff = resolvePrice(a) - resolvePrice(b);\n  if (priceDiff !== 0) return priceDiff;\n\n  const reviewsDiff = (a.reviews ?? 0) - (b.reviews ?? 0);\n  if (reviewsDiff !== 0) return reviewsDiff;\n\n  return a.tripadvisor_id - b.tripadvisor_id;\n}\n\nfunction resolveRating(marker: Property) {\n  if (typeof marker.rating === \"number\") return marker.rating;\n  if (marker.rating === undefined || marker.rating === null) return -Infinity;\n  const parsed = Number(marker.rating);\n  return Number.isNaN(parsed) ? -Infinity : parsed;\n}\n\nfunction resolvePrice(marker: Property) {\n  if (!marker.pricing?.offer?.price) return -Infinity;\n  const numeric = Number(\n    (marker.pricing.offer.displayPrice ?? \"0\")\n      .replace(/[^0-9.,-]+/g, \"\")\n      .replace(/,/g, \"\")\n  );\n  return Number.isNaN(numeric) ? -Infinity : numeric;\n}\n\ntype MapLibreMarkerManagerOptions = {\n  mapInstance: any;\n  maplibregl: MapLibreNamespace;\n  onMarkerClick?: (marker: Property) => void;\n};\n\nclass MapLibreMarkerManager {\n  private readonly mapInstance: any;\n  private readonly MarkerCtor?: MapLibreNamespace[\"Marker\"];\n  private readonly onMarkerClick?: (marker: Property) => void;\n  private activeMarkers: MapLibreMarkerHandle[] = [];\n\n  constructor(options: MapLibreMarkerManagerOptions) {\n    this.mapInstance = options.mapInstance;\n    this.MarkerCtor = options.maplibregl?.Marker;\n    this.onMarkerClick = options.onMarkerClick;\n  }\n\n  render(items: ClusterDisplayItem[]) {\n    this.clear();\n    if (!this.MarkerCtor) {\n      return;\n    }\n    for (const item of items) {\n      const coords = safeLatLon(item.marker.location);\n      if (!coords) continue;\n      const element =\n        item.kind === \"primary\"\n          ? createPrimaryMarkerElement(item, this.onMarkerClick)\n          : createDotMarkerElement(item, this.onMarkerClick);\n      if (!element) continue;\n      const marker = new this.MarkerCtor({\n        element,\n        anchor: item.kind === \"primary\" ? \"bottom\" : \"center\",\n      })\n        .setLngLat([coords.lon, coords.lat])\n        .addTo(this.mapInstance);\n      this.activeMarkers.push(marker);\n    }\n  }\n\n  destroy() {\n    this.clear();\n  }\n\n  private clear() {\n    for (const marker of this.activeMarkers) {\n      try {\n        marker.remove();\n      } catch {\n        // swallow removal errors\n      }\n    }\n    this.activeMarkers = [];\n  }\n}\n\nfunction safeLatLon(location?: { lon?: number; lat?: number }) {\n  if (typeof location?.lon !== \"number\" || typeof location?.lat !== \"number\") {\n    return null;\n  }\n  if (Number.isNaN(location.lon) || Number.isNaN(location.lat)) {\n    return null;\n  }\n  return { lon: location.lon, lat: location.lat };\n}\n\nfunction metersToPixels(meters: number, latitude: number, zoom: number) {\n  const metersPerPixel =\n    (Math.cos((latitude * Math.PI) / 180) * 2 * Math.PI * 6378137) /\n    (256 * 2 ** zoom);\n  if (!Number.isFinite(metersPerPixel) || metersPerPixel <= 0) {\n    return meters;\n  }\n  return meters / metersPerPixel;\n}\n","/**\r\n * Abstract base class for map adapters supporting different map libraries\r\n */\r\nexport abstract class MapAdapter {\r\n  protected map: any;\r\n\r\n  constructor(map: any) {\r\n    this.map = map;\r\n  }\r\n\r\n  /**\r\n   * Get the underlying map instance\r\n   * @returns {any} The native map instance\r\n   */\r\n  getMap(): any {\r\n    return this.map;\r\n  }\r\n  /**\r\n   * Get the current center coordinates of the map\r\n   * @returns {{ lng: number; lat: number }} [longitude, latitude]\r\n   */\r\n  abstract getCenter(): { lng: number; lat: number };\r\n\r\n  /**\r\n   * Get the current zoom level of the map\r\n   * @returns {number} Current zoom level\r\n   */\r\n  abstract getZoom(): number;\r\n\r\n  /**\r\n   * Get the current bearing (rotation) of the map\r\n   * @returns {number} Bearing in degrees\r\n   */\r\n  abstract getBearing(): number;\r\n\r\n  /**\r\n   * Get the current pitch (tilt) of the map\r\n   * @returns {number} Pitch in degrees\r\n   */\r\n  abstract getPitch(): number;\r\n\r\n  /**\r\n   * Get the current bounds of the map viewport\r\n   * @returns {MapBounds} Map bounds with southwest and northeast corners\r\n   */\r\n  abstract getMapBounds(): MapBounds;\r\n\r\n  /**\r\n   * Project a geographical coordinate to screen space\r\n   * @param {[number, number]} lngLat [longitude, latitude]\r\n   * @returns {{ x: number; y: number }} Screen coordinates\r\n   */\r\n  abstract project(lngLat: [number, number]): { x: number; y: number };\r\n}\r\n\r\nexport type LngLat = { lng: number; lat: number };\r\n\r\nexport type MapBounds = {\r\n  sw: { lat: number; lng: number };\r\n  ne: { lat: number; lng: number };\r\n};\r\n","import { MapAdapter, type LngLat, type MapBounds } from \"./index\";\n\nexport class MapLibreAdapter extends MapAdapter {\n  constructor(map: any) {\n    super(map);\n  }\n\n  getMap(): any {\n    return this.map;\n  }\n\n  getCenter(): LngLat {\n    const center = this.map.getCenter();\n    return { lng: center.lng, lat: center.lat };\n  }\n\n  getZoom(): number {\n    return this.map.getZoom();\n  }\n\n  getBearing(): number {\n    return this.map.getBearing();\n  }\n\n  getPitch(): number {\n    return this.map.getPitch();\n  }\n\n  getMapBounds(): MapBounds {\n    const bounds = this.map.getBounds();\n    const sw = bounds.getSouthWest();\n    const ne = bounds.getNorthEast();\n    return {\n      sw: { lat: sw.lat, lng: sw.lng },\n      ne: { lat: ne.lat, lng: ne.lng },\n    };\n  }\n\n  project(lngLat: [number, number]) {\n    return this.map.project;\n  }\n\n  on(event: string, handler: (...args: any[]) => void): void {\n    this.map.on(event, handler);\n  }\n\n  off(event: string, handler: (...args: any[]) => void): void {\n    this.map.off(event, handler);\n  }\n\n  resize(): void {\n    this.map.resize();\n  }\n\n  remove(): void {\n    this.map.remove();\n  }\n}\n","import type { ClusterDisplayItem, Property } from \".\";\n\r\nexport function createDotMarkerElement(\r\n  item: Extract<ClusterDisplayItem, { kind: \"dot\" }>,\r\n  onMarkerClick?: (marker: Property) => void\r\n) {\r\n  if (typeof document === \"undefined\") {\r\n    return null;\r\n  }\r\n  const button = document.createElement(\"button\");\r\n  button.type = \"button\";\r\n  button.style.width = \"14px\";\r\n  button.style.height = \"14px\";\r\n  button.style.borderRadius = \"999px\";\r\n  button.style.border = \"2px solid #ffffff\";\r\n  button.style.background = \"#012b11\";\r\n  button.style.boxShadow = \"0 6px 16px rgba(15, 23, 42, 0.4)\";\r\n  button.style.cursor = \"pointer\";\r\n  button.title = item.marker.name ?? String(item.marker.tripadvisor_id);\r\n\r\n  button.addEventListener(\"click\", (evt) => {\r\n    evt.stopPropagation();\r\n    onMarkerClick?.(item.marker);\r\n  });\r\n\r\n  return button;\r\n}\r\n","import type { ClusterDisplayItem, Property } from \".\";\n\r\nexport function createPrimaryMarkerElement(\r\n  item: Extract<ClusterDisplayItem, { kind: \"primary\" }>,\r\n  onMarkerClick?: (marker: Property) => void\r\n) {\r\n  if (typeof document === \"undefined\") {\r\n    return null;\r\n  }\r\n  const root = document.createElement(\"div\");\r\n  root.style.display = \"flex\";\r\n  root.style.flexDirection = \"column\";\r\n  root.style.alignItems = \"center\";\r\n  root.style.pointerEvents = \"auto\";\r\n\r\n  const pill = document.createElement(\"button\");\r\n  pill.type = \"button\";\r\n  pill.style.background = \"#012b11\";\r\n  pill.style.color = \"#ffffff\";\r\n  pill.style.border = \"none\";\r\n  pill.style.borderRadius = \"999px\";\r\n  pill.style.padding = \"6px 12px\";\r\n  pill.style.fontSize = \"12px\";\r\n  pill.style.fontWeight = \"600\";\r\n  pill.style.fontFamily = \"system-ui, -apple-system, sans-serif\";\r\n  pill.style.boxShadow = \"0 15px 30px rgba(15, 23, 42, 0.45)\";\r\n  pill.style.cursor = \"pointer\";\r\n  pill.style.display = \"flex\";\r\n  pill.style.flexDirection = \"column\";\r\n  pill.style.gap = \"2px\";\r\n  pill.style.minWidth = \"140px\";\r\n  pill.style.maxWidth = \"220px\";\r\n  pill.style.whiteSpace = \"nowrap\";\r\n  pill.style.overflow = \"hidden\";\r\n  pill.style.textOverflow = \"ellipsis\";\r\n  pill.title = item.marker.name ?? String(item.marker.tripadvisor_id);\r\n\r\n  const title = document.createElement(\"span\");\r\n  title.textContent = item.marker.name ?? `#${item.marker.tripadvisor_id}`;\r\n  title.style.textAlign = \"left\";\r\n  pill.appendChild(title);\r\n\r\n  //   if (subtitle) {\r\n  //     const subtitleEl = document.createElement(\"span\");\r\n  //     subtitleEl.textContent = subtitle;\r\n  //     subtitleEl.style.fontSize = \"11px\";\r\n  //     subtitleEl.style.fontWeight = \"500\";\r\n  //     subtitleEl.style.opacity = \"0.85\";\r\n  //     subtitleEl.style.textAlign = \"left\";\r\n  //     pill.appendChild(subtitleEl);\r\n  //   }\r\n\r\n  pill.addEventListener(\"click\", (evt) => {\r\n    evt.stopPropagation();\r\n    onMarkerClick?.(item.marker);\r\n  });\r\n\r\n  const pointer = document.createElement(\"span\");\r\n  pointer.style.width = \"0\";\r\n  pointer.style.height = \"0\";\r\n  pointer.style.borderLeft = \"6px solid transparent\";\r\n  pointer.style.borderRight = \"6px solid transparent\";\r\n  pointer.style.borderTop = `8px solid #012b11`;\r\n  pointer.style.marginTop = \"4px\";\r\n\r\n  root.appendChild(pill);\r\n  root.appendChild(pointer);\r\n  return root;\r\n}\r\n"],"mappings":"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","names":["index_exports","__export","MapFirstCore","__toCommonJS","MapAdapter","map","MapLibreAdapter","MapAdapter","map","center","bounds","sw","ne","lngLat","event","handler","createDotMarkerElement","item","onMarkerClick","_a","button","evt","createPrimaryMarkerElement","item","onMarkerClick","_a","_b","root","pill","title","evt","pointer","DEFAULT_PRIMARY_TYPE","MapFirstCore","options","_a","_b","_c","isMapLibreOptions","shouldAutoSelect","MapLibreAdapter","MapLibreMarkerManager","marker","markers","primary","markerId","_d","viewState","primaryType","collisionPx","dotPx","clusterMarkers","cleanup","extractViewState","radiusMeters","metersToPixels","normalized","mapInstance","rerender","eventName","center","COLLISION_THRESHOLD_PX_ZOOM_BREAKPOINTS","resolveCollisionThreshold","zoom","breakpoint","map","selectedMarkerId","collisionThresholdPx","dotCollisionThresholdPx","projected","index","location","x","y","value","threshold","dotThreshold","resolveDotCollisionThreshold","parent","_","idx","find","i","union","b","rootA","rootB","j","dx","dy","groups","item","root","group","clustered","groupItems","sorted","a","compareMarkers","rest","dotCandidates","remainder","distancePx","followUp","base","aIsPrimary","bIsPrimary","ratingDiff","resolveRating","priceDiff","resolvePrice","reviewsDiff","parsed","numeric","items","coords","safeLatLon","element","createPrimaryMarkerElement","createDotMarkerElement","meters","latitude","metersPerPixel"]}